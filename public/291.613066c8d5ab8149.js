"use strict";(self.webpackChunkfoodapp=self.webpackChunkfoodapp||[]).push([[291],{8291:(K,h,i)=>{i.r(h),i.d(h,{BranchModule:()=>W});var m=i(6019),s=i(7612),_=i(8239),o=i(7537),d=i(5210),n=i(1514),u=i(1579),c=i(3007),Z=i(4585);function x(t,r){1&t&&(n.TgZ(0,"tr"),n.TgZ(1,"td",11),n._UZ(2,"c-spinner",12),n.qZA(),n.qZA())}const p=function(t){return[t]};function A(t,r){if(1&t&&(n.TgZ(0,"tr"),n._UZ(1,"td"),n.TgZ(2,"td",15),n._uU(3),n.qZA(),n.TgZ(4,"td",15),n._uU(5),n.qZA(),n.TgZ(6,"td",15),n._uU(7),n.qZA(),n.TgZ(8,"td"),n._uU(9),n.qZA(),n.qZA()),2&t){const e=r.$implicit;n.xp6(2),n.Q6J("routerLink",n.VKq(7,p,e.id)),n.xp6(1),n.Oqu(e.code),n.xp6(1),n.Q6J("routerLink",n.VKq(9,p,e.id)),n.xp6(1),n.Oqu(e.name),n.xp6(1),n.Q6J("routerLink",n.VKq(11,p,e.id)),n.xp6(1),n.Oqu(e.address),n.xp6(2),n.Oqu(e.managerFullName)}}function b(t,r){1&t&&(n.TgZ(0,"tr"),n.TgZ(1,"td",16),n._uU(2," Empty "),n.qZA(),n.qZA())}function B(t,r){if(1&t&&(n.YNc(0,A,10,13,"tr",13),n.YNc(1,b,3,0,"tr",14)),2&t){const e=n.oxw();n.Q6J("ngForOf",e.page.items),n.xp6(1),n.Q6J("ngIf",0==e.page.items.length)}}let q=(()=>{class t{constructor(e){this.abService=e,this.page=new d.T,this.form=new o.cw({search:new o.NI(null,o.kI.required)}),this.isLoading=!1}ngOnInit(){this.loadBranches()}loadBranches(e){var a=this;return(0,_.Z)(function*(){a.isLoading=!0,yield a.abService.filter(e).forEach(l=>a.page=l).finally(()=>a.isLoading=!1)})()}filter(){this.form.valid?this.loadBranches(this.form.value):this.loadBranches()}onPageChange(e){this.form.valid?(Object.assign(e,this.form.value),this.loadBranches(e)):this.loadBranches({number:e.page})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(u.F))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-branch-list"]],decls:36,vars:5,consts:[[1,"mb-4"],[1,"text-right"],["cButton","","color","primary","routerLink","register"],[3,"formGroup","ngSubmit"],["cFormFloating",""],["cFormControl","","formControlName","search","name","search","type","search","placeholder","Search by username, email or name","autofocus",""],["cLabel","","for","search"],["cTable","","hover",""],[4,"ngIf","ngIfElse"],["showResult",""],[3,"totalItems","ngModel","ngModelChange","pageChanged"],["colspan","5",1,"text-center","my-2"],["aria-hidden","true","label","Loading..."],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"routerLink"],["colspan","5",1,"text-center"]],template:function(e,a){if(1&e&&(n.TgZ(0,"c-card",0),n.TgZ(1,"c-card-body"),n.TgZ(2,"c-row"),n.TgZ(3,"c-col",1),n.TgZ(4,"button",2),n._uU(5,"Register New Branch"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(6,"c-card",0),n.TgZ(7,"c-card-body"),n.TgZ(8,"c-row"),n.TgZ(9,"c-col"),n.TgZ(10,"form",3),n.NdJ("ngSubmit",function(){return a.filter()}),n.TgZ(11,"div",4),n._UZ(12,"input",5),n.TgZ(13,"label",6),n._uU(14,"Search by code, name or address"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(15,"c-card",0),n.TgZ(16,"c-card-body"),n.TgZ(17,"c-row"),n.TgZ(18,"c-col"),n.TgZ(19,"table",7),n.TgZ(20,"thead"),n.TgZ(21,"tr"),n._UZ(22,"th"),n.TgZ(23,"th"),n._uU(24,"Code"),n.qZA(),n.TgZ(25,"th"),n._uU(26,"Name"),n.qZA(),n.TgZ(27,"th"),n._uU(28,"Address"),n.qZA(),n.TgZ(29,"th"),n._uU(30,"Manager"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(31,"tbody"),n.YNc(32,x,3,0,"tr",8),n.YNc(33,B,2,2,"ng-template",null,9,n.W1O),n.qZA(),n.qZA(),n.TgZ(35,"pagination",10),n.NdJ("ngModelChange",function(g){return a.page.number=g})("pageChanged",function(g){return a.onPageChange(g)}),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&e){const l=n.MAs(34);n.xp6(10),n.Q6J("formGroup",a.form),n.xp6(22),n.Q6J("ngIf",a.isLoading)("ngIfElse",l),n.xp6(3),n.Q6J("totalItems",a.page.total)("ngModel",a.page.number)}},directives:[c.AkF,c.yue,c.iok,c.Yp0,c.Hq3,s.rH,o._Y,o.JL,o.sg,c.xPZ,c.oHf,o.Fj,o.JJ,o.u,c.eFW,c.auY,m.O5,Z.Qt,o.On,c.ORR,m.sg],styles:[""]}),t})();var v=i(2967),C=i(8119),w=i(2282),M=i(1071),I=i(9789),y=i(9832);function F(t,r){1&t&&(n.TgZ(0,"c-row",2),n.TgZ(1,"c-col",2),n._UZ(2,"c-spinner",3),n.TgZ(3,"span",4),n._uU(4," Loading... "),n.qZA(),n.qZA(),n.qZA())}function J(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"c-card-body"),n.TgZ(1,"c-row"),n.TgZ(2,"c-col"),n.TgZ(3,"h4"),n._uU(4),n.qZA(),n.TgZ(5,"strong"),n._uU(6),n.qZA(),n.qZA(),n.TgZ(7,"c-col",11),n.TgZ(8,"span",12),n.TgZ(9,"button",13),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).editBranch()}),n._uU(10,"Edit"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&t){const e=n.oxw(2);n.xp6(4),n.Oqu(e.branch.name),n.xp6(2),n.Oqu(e.branch.code)}}function E(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"c-card-body"),n.TgZ(1,"form",14),n.NdJ("ngSubmit",function(){return n.CHM(e),n.oxw(2).saveBranch()}),n.TgZ(2,"fieldset",15),n.TgZ(3,"c-row"),n.TgZ(4,"c-col",16),n._UZ(5,"input",17),n._UZ(6,"app-input-error",18),n.qZA(),n.TgZ(7,"c-col",16),n._UZ(8,"input",19),n._UZ(9,"app-input-error",18),n.qZA(),n.TgZ(10,"c-col",16),n.TgZ(11,"span",20),n.TgZ(12,"button",21),n.NdJ("click",function(){return n.CHM(e),n.oxw(2).cancelEditBranch()}),n._uU(13,"Cancel"),n.qZA(),n.TgZ(14,"button",22),n._uU(15," Save "),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&t){const e=n.oxw(2);n.xp6(1),n.Q6J("formGroup",e.branchForm),n.xp6(1),n.Q6J("disabled",e.savingBranch),n.xp6(3),n.Q6J("valid",e.branchForm.controls.code.valid),n.xp6(1),n.Q6J("control",e.branchForm.controls.code),n.xp6(2),n.Q6J("valid",e.branchForm.controls.name.valid),n.xp6(1),n.Q6J("control",e.branchForm.controls.name),n.xp6(5),n.Q6J("loading",e.savingBranch)}}const N=function(t){return["/manager",t]};function U(t,r){if(1&t&&(n.TgZ(0,"span"),n.TgZ(1,"h4"),n._uU(2),n.qZA(),n.TgZ(3,"a",28),n._uU(4),n.qZA(),n.qZA()),2&t){const e=n.oxw(4);n.xp6(2),n.Oqu(null==e.branch.manager?null:e.branch.manager.fullName),n.xp6(1),n.Q6J("routerLink",n.VKq(3,N,e.branch.managerId)),n.xp6(1),n.hij(" ",null==e.branch.manager?null:e.branch.manager.username," ")}}function L(t,r){1&t&&n._uU(0,"N/A")}function O(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"c-row"),n.TgZ(1,"c-col"),n.YNc(2,U,5,5,"span",23),n.YNc(3,L,1,0,"ng-template",null,25,n.W1O),n.qZA(),n.TgZ(5,"c-col",26),n.TgZ(6,"span",12),n.TgZ(7,"button",27),n.NdJ("click",function(){return n.CHM(e),n.oxw(3).editManager()}),n._uU(8,"Edit"),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&t){const e=n.MAs(4),a=n.oxw(3);n.xp6(2),n.Q6J("ngIf",a.branch.managerId)("ngIfElse",e)}}function S(t,r){if(1&t&&(n.TgZ(0,"option",36),n._uU(1),n.qZA()),2&t){const e=r.$implicit;n.Q6J("value",e.id),n.xp6(1),n.hij(" ",e.fullName," ")}}function Q(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"span"),n.TgZ(1,"select",33),n.NdJ("ngModelChange",function(l){return n.CHM(e),n.oxw(4).selectedManagerId=l}),n.TgZ(2,"option",34),n._uU(3,"None"),n.qZA(),n.YNc(4,S,2,2,"option",35),n.qZA(),n.qZA()}if(2&t){const e=n.oxw(4);n.xp6(1),n.Q6J("ngModel",e.selectedManagerId),n.xp6(3),n.Q6J("ngForOf",e.managerPage.items)}}function V(t,r){1&t&&n._UZ(0,"c-spinner",3)}function Y(t,r){if(1&t){const e=n.EpF();n.TgZ(0,"form",29),n.NdJ("ngSubmit",function(){return n.CHM(e),n.oxw(3).saveBranchManager()}),n.TgZ(1,"fieldset",15),n.TgZ(2,"c-row"),n.TgZ(3,"c-col"),n.YNc(4,Q,5,2,"span",23),n.YNc(5,V,1,0,"ng-template",null,30,n.W1O),n.qZA(),n.TgZ(7,"c-col",31),n.TgZ(8,"span",20),n.TgZ(9,"button",27),n.NdJ("click",function(){return n.CHM(e),n.oxw(3).cancelEditManager()}),n._uU(10,"Cancel"),n.qZA(),n.TgZ(11,"button",32),n._uU(12," Save "),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&t){const e=n.MAs(6),a=n.oxw(3);n.xp6(1),n.Q6J("disabled",a.savingManager),n.xp6(3),n.Q6J("ngIf",!a.managerLoading)("ngIfElse",e),n.xp6(7),n.Q6J("loading",a.savingManager)}}function k(t,r){if(1&t&&(n.TgZ(0,"h4"),n._uU(1,"Manager"),n.qZA(),n.TgZ(2,"c-card"),n.TgZ(3,"c-card-body"),n.YNc(4,O,9,2,"c-row",23),n.YNc(5,Y,13,4,"ng-template",null,24,n.W1O),n.qZA(),n.qZA()),2&t){const e=n.MAs(6),a=n.oxw(2);n.xp6(4),n.Q6J("ngIf",!a.isEditManager)("ngIfElse",e)}}function R(t,r){if(1&t&&(n.TgZ(0,"c-row",5),n.TgZ(1,"c-col",6),n.TgZ(2,"c-card",7),n.YNc(3,J,11,2,"ng-template",8),n.YNc(4,E,16,7,"ng-template",null,9,n.W1O),n.qZA(),n.YNc(6,k,7,2,"ng-template",10),n.qZA(),n.qZA()),2&t){const e=n.MAs(5),a=n.oxw();n.xp6(3),n.Q6J("ngIf",!a.isEditBranch)("ngIfElse",e),n.xp6(3),n.Q6J("ngIf",a.branch.id)}}let f=(()=>{class t{constructor(e,a,l,g,G){this.route=e,this.router=a,this.amService=l,this.abService=g,this.commonService=G,this.branch=new C.I,this.isLoading=!1,this.branchForm=new o.cw({code:new o.NI(null,[o.kI.required,o.kI.minLength(2),o.kI.maxLength(16)]),name:new o.NI(null,[o.kI.required])}),this.isEditBranch=!1,this.savingBranch=!1,this.isEditManager=!1,this.selectedManagerId=null,this.managerPage=new d.T,this.managerLoading=!1,this.savingManager=!1,this.alert=new v.b;let T=this.route.snapshot.params.id;T&&(this.branch.id=T)}ngOnInit(){var e=this;return(0,_.Z)(function*(){""!=e.branch.id?(e.isLoading=!0,yield e.abService.get(e.branch.id).forEach(a=>e.branch=a).finally(()=>e.isLoading=!1)):e.editBranch()})()}editBranch(){this.branch&&this.branch.id&&(this.branchForm.controls.code.setValue(this.branch.code),this.branchForm.controls.name.setValue(this.branch.name)),this.isEditBranch=!0}cancelEditBranch(){this.branchForm.reset(),this.isEditBranch=!1}saveBranch(){if(this.branchForm.valid){this.savingBranch=!0;let e=this.branchForm.value;this.branch&&this.branch.id&&(e.id=this.branch.id),this.abService.save(e).forEach(a=>{a&&a.error||a&&(Object.assign(this.branch,a),this.isEditBranch=!1)}).catch(a=>{a&&"ER_DUP_ENTRY"==a.code&&this.branchForm.controls.code.setErrors({else:"this code is already registered, try another one"})}).finally(()=>{this.savingBranch=!1})}}loadManager(){this.managerLoading=!0,this.amService.available().forEach(e=>this.managerPage=e).finally(()=>this.managerLoading=!1)}editManager(){this.managerPage&&0==this.managerPage.items.length&&this.loadManager(),this.isEditManager=!0}cancelEditManager(){this.isEditManager=!1,this.selectedManagerId=null}saveBranchManager(){var e=this;return(0,_.Z)(function*(){e.selectedManagerId&&e.branch.id&&(e.savingManager=!0,yield e.abService.updateManager(e.branch.id,{managerId:e.selectedManagerId}).forEach(a=>{console.log(a),Object.assign(e.branch,a),e.isEditManager=!1,e.loadManager()}).catch(a=>console.log(a)).finally(()=>{e.selectedManagerId=null,e.savingManager=!1}))})()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(s.gz),n.Y36(s.F0),n.Y36(w.f),n.Y36(u.F),n.Y36(M.v))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-branch-view"]],decls:3,vars:2,consts:[["class","",4,"ngIf","ngIfElse"],["elseBlock",""],[1,""],["size","sm"],[1,"d-flex-inline","my-auto"],[1,"justify-content-center"],["md","8"],[1,"mb-4"],[3,"ngIf","ngIfElse"],["branchFormBlock",""],[3,"ngIf"],["xs","1"],[1,"float-end"],["cButton","","size","sm","color","light",3,"click"],[3,"formGroup","ngSubmit"],[3,"disabled"],["sm","4"],["formControlName","code","cFormControl","","id","code","placeholder","Code","type","text","autofocus","",3,"valid"],[3,"control"],["formControlName","name","cFormControl","","id","name","placeholder","Name","type","text",3,"valid"],[1,"d-grid","gap-2","d-flex","float-end"],["cButton","","type","button","color","light",3,"click"],["xcButton","","loadingLabel","Saving...","type","submit","color","primary",3,"loading"],[4,"ngIf","ngIfElse"],["managerForm",""],["na",""],["xs","2"],["cButton","","color","light","size","sm",3,"click"],["cButton","","color","light","size","sm",3,"routerLink"],[3,"ngSubmit"],["loader",""],["xs","4"],["xcButton","","loadingLabel","Saving...","type","submit","size","sm",3,"loading"],["cSelect","","name","branch",3,"ngModel","ngModelChange"],["value","null"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,a){if(1&e&&(n.YNc(0,F,5,0,"c-row",0),n.YNc(1,R,7,3,"ng-template",null,1,n.W1O)),2&e){const l=n.MAs(2);n.Q6J("ngIf",a.isLoading)("ngIfElse",l)}},directives:[m.O5,c.iok,c.Yp0,c.ORR,c.AkF,c.yue,c.Hq3,o._Y,o.JL,o.sg,o.Fj,c.oHf,o.JJ,o.u,I.w,y.L,s.yS,o.F,c.nqR,o.EJ,o.On,o.YN,o.Kr,m.sg],styles:[""]}),t})();const H=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-branch"]],decls:1,vars:0,template:function(e,a){1&e&&n._UZ(0,"router-outlet")},directives:[s.lC],styles:[""]}),t})(),children:[{path:"",component:q,data:{title:"Search"}},{path:"register",component:f,data:{title:"Register New Branch"}},{path:":id",component:f,data:{title:"Detail"}}]}];let j=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[s.Bz.forChild(H)],s.Bz]}),t})();var z=i(1382);const P=[c.zE6,c.dTQ,c.nMh,c.ejP,c.hJ1,c.Fme,c.U$I];let W=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[[m.ez,j,z.m,...P,o.UX,o.u5,Z.u3.forRoot()]]}),t})()}}]);